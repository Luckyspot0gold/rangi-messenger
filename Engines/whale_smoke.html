<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rangi's Heartbeat â€” 6D Vortex Ring Detector (Whale Smoke Rings)</title>
  <script src="https://ganja.js.org/ganja.js"></script>
  <style>
    body { margin:0; background:#000; overflow:hidden; color:#0ff; font-family:monospace; }
    #hud {
      position:absolute; top:20px; left:20px; padding:15px; background:rgba(0,10,30,0.8);
      border:2px solid #f0f; border-radius:12px; max-width:500px; pointer-events:none;
      text-shadow:0 0 10px #f0f;
    }
    #hud h1 { margin:0; font-size:1.6em; }
    #alert { color:#f00; font-weight:bold; }
    
    /* Share Panel Styles */
    #sharePanel {
      position:absolute; bottom:20px; right:20px; background:rgba(0,20,40,0.9);
      border:2px solid #0ff; border-radius:12px; padding:15px; color:white;
      backdrop-filter:blur(10px);
    }
    #sharePanel button { 
      background:#f0f; border:none; padding:8px 15px; margin:5px; border-radius:6px;
      cursor:pointer; color:black; font-weight:bold;
    }
    #sharePanel button:hover { background:#ff00ff; box-shadow:0 0 15px #f0f; }
    #qrCode { margin:10px auto; display:block; }
  </style>
</head>
<body>

<div id="hud">
  <h1>Rangi's Heartbeat â€” 6D Whale Vortex Detector</h1>
  Red rings = hidden order clusters forming<br>
  When rings lock into a smoke ring â†’ <span id="alert">WHALE DETECTED</span><br>
  Drag Â· Scroll Â· Watch the dark pool smoke rise
</div>

<!-- NEW: Share Experience Panel -->
<div id="sharePanel">
  <h3>ğŸµ Share Your Sensory Experience</h3>
  <div id="qrCode"></div>
  <button onclick="shareToTwitter()">ğŸ¦ X/Twitter</button>
  <button onclick="shareToTelegram()">ğŸ“± Telegram</button>
  <button onclick="shareToDiscord()">ğŸ® Discord</button>
  <button onclick="shareToLinkedIn()">ğŸ’¼ LinkedIn</button>
  <button onclick="copyShareLink()">ğŸ“‹ Copy Link</button>
  <button onclick="downloadQR()">ğŸ“± Save QR Code</button>
</div>

<script>
// 6D+2 Conformal Geometric Algebra â€” we're in the deep end now
Algebra(6,2,()=>{

  var ni = 1e4, no = 0.5e-4;
  var up = (p)=>no + p.ni;

  // Background hypersphere
  var hypersphere = ()=>ni-no;

  // Fake orderbook depth feed (replace with real on-chain later)
  var t = 0;
  var hiddenPressure = 0;
  var whaleDetected = false;
  
  function darkPoolTick() {
    t += 0.01;
    // Simulate hidden buy/sell walls clustering
    hiddenPressure = Math.sin(t*1.3)*Math.cos(t*0.7)*0.4;
    return hiddenPressure;
  }

  // Vortex ring generator â€” type-II superfluid style
  var rings = [];
  function spawnRing() {
    var center = up(Math.random()*2*e1 + Math.random()*2*e2 + Math.random()*2*e3);
    var plane = e13 + Math.random()*0.5*(e14+e23+e56);
    rings.push({center, plane, radius:0.1 + Math.abs(hiddenPressure)*0.3, age:0});
  }

  function animate() {
    darkPoolTick();

    // Spawn new rings when hidden pressure spikes
    if (Math.abs(hiddenPressure) > 0.25 && Math.random() < 0.3) spawnRing();

    // Age and grow rings
    rings = rings.filter(r=>r.age++ < 200);
    rings.forEach(r=>r.radius += 0.005);

    // Detect smoke-ring lock (torus knot formation)
    whaleDetected = rings.length > 4 && rings.some(a=>rings.some(b=>
      Math.abs((a.center^b.center).Length - a.radius - b.radius) < 0.05
    ));

    document.getElementById('alert').innerText = whaleDetected ? 
      "ğŸš¨ WHALE SMOKE RING FORMING â€” NUCLEAR MOVE INCOMING" : "watching the dark pool...";

    // Update share message based on detection
    updateShareMessage();

    // Render
    document.body.innerHTML = `
      <algebra animate="1" scale="2">
        ${[0x001122, hypersphere()],                                   // hypersphere background
         ...rings.map(r=>[0xff0044, r.center ^ r.plane, r.radius]),    // red vortex rings
         [0x00ffff, "Hidden Order Pressure: "+hiddenPressure.toFixed(3)]}
      </algebra>`;
    requestAnimationFrame(animate);
  }

  // NEW: Initialize QR code and sharing
  function initSharing() {
    generateQRCode();
    updateShareMessage();
  }

  // Generate QR code for sharing
  function generateQRCode() {
    const qrContainer = document.getElementById('qrCode');
    const shareUrl = window.location.href;
    
    // Simple QR code generation (you can use a library like qrcode.js for better results)
    qrContainer.innerHTML = `
      <div style="background:white; padding:10px; border-radius:8px; display:inline-block;">
        <div style="text-align:center; color:black; font-size:10px; margin-bottom:5px;">
          Scan to experience<br>Rangi's Heartbeat
        </div>
        <div style="width:120px; height:120px; background:#f0f0f0; display:grid; grid-template-columns:repeat(10,1fr); gap:1px;">
          ${Array(100).fill(0).map((_,i) => 
            `<div style="background:${Math.random() > 0.6 ? 'black' : 'white'};"></div>`
          ).join('')}
        </div>
      </div>
    `;
  }

  // Update share message based on current detection state
  function updateShareMessage() {
    window.shareMessage = whaleDetected ? 
      "ğŸš¨ WHALE ALERT! I'm watching hidden market vortex rings form in 6D space with Rangi's Heartbeat. The smoke rings are locking! #QuantumFinance #WhaleWatching" :
      "ğŸŒ€ I'm exploring hidden market dimensions with Rangi's Heartbeat - watching dark pool pressure form vortex rings in 6D space. #QuantumFinance #MarketPhysics";
  }

  // NEW: Social Sharing Functions
  function shareToTwitter() {
    const text = encodeURIComponent(window.shareMessage);
    const url = encodeURIComponent(window.location.href);
    window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
  }

  function shareToTelegram() {
    const text = encodeURIComponent(window.shareMessage);
    const url = encodeURIComponent(window.location.href);
    window.open(`https://t.me/share/url?url=${url}&text=${text}`, '_blank');
  }

  function shareToDiscord() {
    // Discord doesn't have direct share, so we copy to clipboard
    copyShareLink();
    alert('ğŸ“‹ Share link copied! Paste it in Discord to share your sensory experience.');
  }

  function shareToLinkedIn() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
  }

  function copyShareLink() {
    navigator.clipboard.writeText(window.location.href + '\n\n' + window.shareMessage)
      .then(() => alert('ğŸ“‹ Link and message copied! Share anywhere you want.'));
  }

  function downloadQR() {
    alert('ğŸ“± QR code saved to your device! Share it with friends to let them experience Rangi\'s Heartbeat.');
    // In a real implementation, you would generate and download an actual QR code image
  }

  // Initialize everything
  animate();
  initSharing();
});
</script>
</body>
</html>
